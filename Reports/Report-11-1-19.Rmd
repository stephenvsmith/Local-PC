---
title: "Report"
output: pdf_document
---

```{r,echo=FALSE}
knitr::opts_knit$set(root.dir = "/home/stephen/Desktop/Research/Results/population/")
knitr::opts_chunk$set(echo = FALSE,message = FALSE,fig.height = 4)
```

```{r grab files}
completed_networks <- list.files()

results <- list()

for (net in completed_networks){
  net.dir <- paste0(getwd(),"/",net,"/")
  result.file <- paste0(net.dir,net," results.txt")
  if (file.exists(result.file)){
    results[[net]] <- read.table(result.file)
  }
}
results_df <- do.call(rbind,results)
```

## Population Version

The data consists of `r nrow(results_df)` simulations from networks from the ``bnlearn`` repository. In order to determine conditional independence for the population version, we consider $d$-separation from the true DAG. For the estimation of the skeleton, the maximum number of nodes we consider in a separating set is 3 (our default). For each network, we consider target sets $T$ with $|T| \in \{1,2,3,4,5\}$. Below is a table of some of the results

### Same V-Structures
Comparing only the nodes in the neighborhood, we found that in all 930 cases, the population PC correctly identified all the V-structures

### SHD
Also, for all 930 cases, we found that the SHD was 0 in every case.

### False Negatives and False Positives
Since we do not implement all of Meek's rules in the local setting, we can view some other statistics concerning false negatives and false positives. Each number in the table below is the number of times that number of false positives/false negatives are observed for a particular network and set of target nodes. These statistics come from comparisons between the estimated CPDAG and the true CPDAG.

**False Negatives**
```{r}
table(results_df$fn)
```

**False Positives**
```{r}
table(results_df$fp)
```

These tables are equivalent because each false negative and false positive represents an undirected edge in the estimated CPDAG that is directed in the true CPDAG.

### Visualizations

#### False Negatives
```{r}
library(ggplot2)
theme_set(theme_bw())
ggplot(results_df,aes(fn))+geom_histogram()+ggtitle("Distribution of Number of False Negatives")+xlab("# of FNs in Simulations")
```

```{r}
ggplot(results_df,aes(fn))+geom_histogram()+facet_wrap(~Number_of_Targets,scales = "free")+ggtitle("Distribution of FNs for Different Number of Targets")
ggplot(results_df,aes(fn))+geom_histogram()+facet_wrap(~Network,scales = "free")+ggtitle("Distribution of FNs for Different Networks")
```

#### True Positives
```{r}
ggplot(results_df,aes(tp))+geom_histogram()+facet_wrap(~Number_of_Targets,scales = "free")+ggtitle("Distribution of True Positives for Different Number of Targets")
```

```{r}
ggplot(results_df,aes(tp))+geom_histogram()+facet_wrap(~Network,scales = "free")+ggtitle("Distribution of TPs for Different Networks")
```


## Sample Version
This is a preliminary display of the results. We are using a significance level of 0.005 for our hypothesis tests.

```{r grab files2}
sample.dir <- "/home/stephen/Desktop/Research/Results/sample/"
completed_networks <- list.files(sample.dir)

results <- list()

for (net in completed_networks){
  net.dir <- paste0(sample.dir,net,"/")
  result.file <- paste0(net.dir,net," results.txt")
  if (file.exists(result.file)){
    results[[net]] <- read.table(result.file)
  }
}
results_df <- do.call(rbind,results)
```

### Same V-Structures

```{r}
table(results_df$Same_V_Structures)
```

### SHD

```{r}
table(results_df$SHD)
```

```{r}
ggplot(results_df,aes(SHD))+geom_histogram()+facet_wrap(~Network)
ggplot(results_df,aes(SHD))+geom_histogram()+facet_wrap(~Number_of_Targets)
```

### False Negatives
```{r}
ggplot(results_df,aes(fn))+geom_histogram()+facet_wrap(~Network)
ggplot(results_df,aes(fn))+geom_histogram()+facet_wrap(~Number_of_Targets)
```

### False Positives
```{r}
ggplot(results_df,aes(fp))+geom_histogram()+facet_wrap(~Network)
ggplot(results_df,aes(fp))+geom_histogram()+facet_wrap(~Number_of_Targets)
```

